*=======================================================================
* File:    sptest.f
* Author:  Alex Stivala
* Created: July 2008
*
* sptest - test harness for spsoqp
*
* $Id: sptest.f 1693 2008-07-16 05:47:54Z astivala $
*=======================================================================

      program sptest

      implicit none

      integer           m,n,j,info
      parameter         (m = 6, n = 15)
      double precision  Q(n,n),A(m, n),x(n+1),y(m),b(m),c(n)

      external solvqp

      data Q /0.0, 0.0, 0.0, 0.0, 0.0, -0.02d0, 0.0,
     $        0.0, -0.14d0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
     $     0.0, 0.0, 0.0, 0.0, 0.0, -0.015d0, 0.0,
     $        0.0, -0.105d0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
     $     0.0, 0.0, 0.0, -0.02d0, -0.015d0, 0.0, -0.14d0,
     $        -0.105d0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
     $     0.0, 0.0, -0.02d0, 0.0, 0.0, 0.0, 0.0,
     $        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
     $     0.0, 0.0, -0.015d0, 0.0, 0.0, 0.0, 0.0, 
     $        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
     $     -0.02d0, -0.015d0, 0.0, 0.0, 0.0, 0.0, 0.0,
     $        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
     $     0.0, 0.0, -0.14d0, 0.0, 0.0, 0.0, 0.0,
     $        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
     $     0.0, 0.0, -0.105d0, 0.0, 0.0, 0.0, 0.0,
     $        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
     $     -0.14d0, -0.105d0, 0.0, 0.0, 0.0, 0.0, 0.0,
     $        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
     $     0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
     $        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
     $     0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
     $        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
     $     0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
     $        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
     $     0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
     $        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
     $     0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
     $        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
     $     0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
     $        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 /


      data A /1.0, 0.0, 0.0, 1.0, 0.0, 0.0,
     $        1.0, 0.0, 0.0, 0.0, 1.0, 0.0,
     $        1.0, 0.0, 0.0, 0.0, 0.0, 1.0,
     $        0.0, 1.0, 0.0, 1.0, 0.0, 0.0,
     $        0.0, 1.0, 0.0, 0.0, 1.0, 0.0,
     $        0.0, 1.0, 0.0, 0.0, 0.0, 1.0,
     $        0.0, 0.0, 1.0, 1.0, 0.0, 0.0,
     $        0.0, 0.0, 1.0, 0.0, 1.0, 0.0,
     $        0.0, 0.0, 1.0, 0.0, 0.0, 1.0,
     $        1.0, 0.0, 0.0, 0.0, 0.0, 0.0,
     $        0.0, 1.0, 0.0, 0.0, 0.0, 0.0,
     $        0.0, 0.0, 1.0, 0.0, 0.0, 0.0,
     $        0.0, 0.0, 0.0, 1.0, 0.0, 0.0,
     $        0.0, 0.0, 0.0, 0.0, 1.0, 0.0,
     $        0.0, 0.0, 0.0, 0.0, 0.0, 1.0/

      data b /m*1.0/

      data c /0.0377777777777777d0,
     $     0.0377777777777777d0,
     $     0.0377777777777777d0,
     $     0.0377777777777777d0,
     $     0.0377777777777777d0,
     $     0.0477777777777777d0,
     $     0.0377777777777777d0,
     $    -0.3122222222222222d0,
     $     0.0377777777777777d0,
     $     0,
     $     0,
     $     0,
     $     0,
     $     0,
     $     0/


      call solvqp(Q, n, A, m, m, n, b, c, x, y, info)
      if (info .ne. 0) then
         write(*,200),info
 200     format('spsoqp failed, info = ',i2)
      else
         write(*,300),x(n+1)
 300     format (' ob = ',f8.4)
         write(*,*),'x = '
         write(*,410), (x(j), j = 1, n)
 410     format (f8.4)
      endif

      end

